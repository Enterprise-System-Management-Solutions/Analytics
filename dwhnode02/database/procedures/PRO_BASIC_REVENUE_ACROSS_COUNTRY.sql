--
-- PRO_BASIC_REVENUE_ACROSS_COUNTRY  (Procedure) 
--
CREATE OR REPLACE PROCEDURE DWH_USER.PRO_BASIC_REVENUE_ACROSS_COUNTRY IS
    VDATE_KEY       NUMBER;
BEGIN

SELECT DATE_KEY INTO VDATE_KEY
FROM DATE_DIM WHERE TO_CHAR(DATE_VALUE,'RRRRMMDD')=TO_CHAR(SYSDATE-1,'RRRRMMDD');

    
DELETE BASIC_REVENUE_ACROSS_COUNTRY WHERE PDR_DATE_KEY=VDATE_KEY;
COMMIT;
    
INSERT INTO BASIC_REVENUE_ACROSS_COUNTRY


Select TOTAL_REVENUE,VOICE_REVENUE,DATA_REVENUE, SMS_PPU_REVENUE,OTHER_REVENUE,YOUTH_REVENUE,AGAMI_REVENUE, BORNOMALA_REVENUE ,
  SAGOTOM_REVENUE,OPORAJITA_REVENUE,MAYERHASI_REVENUE,CORPORATE_REVENUE,MODEM_MIFI_REVENUE,OTHER_PACKAGE_REVENUE ,VDATE_KEY
 from

(SELECT  COALESCE (A.VOICE_PPU_REVENUE, 0)
        + COALESCE (B.DATA_PPU_REVENUE, 0)
        + COALESCE (C.RECURRING_REVENUE, 0)
        + COALESCE (D.SMS_PPU_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        TOTAL_REVENUE ,
        
         COALESCE (A.VOICE_PPU_REVENUE, 0)
        + COALESCE (H.VOICE_RECURRING_REVENUE, 0)
         VOICE_REVENUE,
         
           COALESCE (B.DATA_PPU_REVENUE, 0)
        + COALESCE (G.DATA_RECURRING_REVENUE, 0)
         DATA_REVENUE,
         
         SMS_PPU_REVENUE,
         
          COALESCE (I.COMBO_RECURRING_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        OTHER_REVENUE 
         
         
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_PPU_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_PPU_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) RECURRING_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_PPU_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))  )F,
         
         (SELECT /*+PARALLEL(X,8)*/  SUM(R41_DEBIT_AMOUNT) DATA_RECURRING_REVENUE
          FROM L3_RECURRING X
          WHERE (R377_CYCLEBEGINTIME_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE( SYSDATE-1,'DD/MM/RRRR'))
                 )
     
          AND 
          EXISTS
          (
          SELECT * FROM OFFER_DATA_DIM
          WHERE OFFERID=X.R385_OFFERINGID
      
          )
          )G,
          
           (SELECT /*+PARALLEL(Y,8)*/  SUM(R41_DEBIT_AMOUNT) VOICE_RECURRING_REVENUE
          FROM L3_RECURRING Y
          WHERE (R377_CYCLEBEGINTIME_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE( SYSDATE-1,'DD/MM/RRRR'))
                 )
     
          AND 
          EXISTS
          (
          SELECT * FROM OFFER_VOICE_DIM
          WHERE OFFERID=Y.R385_OFFERINGID
      
          )
          )H,
          
          
            (SELECT /*+PARALLEL(Z,8)*/  SUM(R41_DEBIT_AMOUNT) COMBO_RECURRING_REVENUE
          FROM L3_RECURRING Z
          WHERE (R377_CYCLEBEGINTIME_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE( SYSDATE-1,'DD/MM/RRRR'))
                 )
     
          AND 
          EXISTS
          (
          SELECT * FROM OFFER_COMBO_DIM
          WHERE OFFERID=Z.R385_OFFERINGID
      
          )
          )I
          
)P,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        YOUTH_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID in (400014,400016,400017,300050)
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID in (400014,400016,400017,300050)
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID in (400014,400016,400017,300050)
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID in (400014,400016,400017,300050)
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID in (400014,400016,400017,300050)
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID in (400014,400016,400017,300050)
         
           )F
)Q,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        AGAMI_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID in (300033,400012)
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID in (300033,400012)
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID in (300033,400012)
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID in (300033,400012)
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID in (300033,400012)
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID in (300033,400012)
         
           )F
)R,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        BORNOMALA_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID in (300034,400015)
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID in (300034,400015)
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID in (300034,400015)
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID in (300034,400015)
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID in (300034,400015)
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID in (300034,400015)
         
           )F
)S,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        SAGOTOM_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID =479662
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID =479662
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID =479662
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID =479662
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID =479662
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID =479662
         
           )F
)T,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        OPORAJITA_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID =400019
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID =400019
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID =400019
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID =400019
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID =400019
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID =400019
         
           )F
)U,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        MAYERHASI_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID =400018
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID =400018
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID =400018
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID =400018
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID =400018
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID =400018
         
           )F
)V,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        CORPORATE_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID in (200002,300022,300042,449066,449073,410010,410008,410009,449103,200001)
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID in (200002,300022,300042,449066,449073,410010,410008,410009,449103,200001)
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID in (200002,300022,300042,449066,449073,410010,410008,410009,449103,200001)
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID in (200002,300022,300042,449066,449073,410010,410008,410009,449103,200001)
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID in (200002,300022,300042,449066,449073,410010,410008,410009,449103,200001)
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID in (200002,300022,300042,449066,449073,410010,410008,410009,449103,200001)
         
           )F
)W,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        MODEM_MIFI_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID in (449066,449073,410013,449662,449103,400022,400021)
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID in (449066,449073,410013,449662,449103,400022,400021)
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID in (449066,449073,410013,449662,449103,400022,400021)
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID in (449066,449073,410013,449662,449103,400022,400021)
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID in (449066,449073,410013,449662,449103,400022,400021)
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID in (449066,449073,410013,449662,449103,400022,400021)
         
           )F
)X,
(SELECT  COALESCE (A.VOICE_REVENUE, 0)
        + COALESCE (B.DATA_REVENUE, 0)
        + COALESCE (C.VAS_REVENUE, 0)
        + COALESCE (D.SMS_REVENUE, 0)
        + COALESCE (E.CONTENT_REVENUE, 0)
        + COALESCE (F.ADJUSTMENT_REVENUE, 0)
        OTHER_PACKAGE_REVENUE 
        FROM
        (SELECT /*+PARALLEL(P,8)*/ SUM(V41_DEBIT_AMOUNT) VOICE_REVENUE FROM L3_VOICE P
        WHERE V387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
        and V397_MAINOFFERINGID not in (400014,400016,400017,300050,300033,400012,300034,400015,479662,400019,400018,200002,300022,300042,449066,449073,410010,410008,410009,449103,200001,410013,449662,400022,400021)
        
         ) A,
        (SELECT /*+PARALLEL(Q,8)*/ SUM(G41_DEBIT_AMOUNT) DATA_REVENUE FROM L3_DATA Q
        WHERE G383_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
         and G401_MAINOFFERINGID not in (400014,400016,400017,300050,300033,400012,300034,400015,479662,400019,400018,200002,300022,300042,449066,449073,410010,410008,410009,449103,200001,410013,449662,400022,400021)
        
        )B,
        (SELECT /*+PARALLEL(R,8)*/ SUM(R41_DEBIT_AMOUNT) VAS_REVENUE FROM L3_RECURRING R
        WHERE R377_CYCLEBEGINTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and R373_MAINOFFERINGID not in (400014,400016,400017,300050,300033,400012,300034,400015,479662,400019,400018,200002,300022,300042,449066,449073,410010,410008,410009,449103,200001,410013,449662,400022,400021)
        
         )C,
        (SELECT /*+PARALLEL(S,8)*/ SUM(S41_DEBIT_AMOUNT) SMS_REVENUE FROM L3_SMS S
        WHERE S387_CHARGINGTIME_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR')) 
        and S395_MAINOFFERINGID not in (400014,400016,400017,300050,300033,400012,300034,400015,479662,400019,400018,200002,300022,300042,449066,449073,410010,410008,410009,449103,200001,410013,449662,400022,400021)
        
        )D,
        (SELECT /*+PARALLEL(T,8)*/ SUM(CO41_DEBIT_AMOUNT) CONTENT_REVENUE FROM L3_CONTENT T
        WHERE CO402_STARTTIMEOFBILLCYL_KEY = (SELECT A.DATE_KEY FROM DATE_DIM A WHERE A.DATE_VALUE = TO_DATE(SYSDATE - 1,'DD/MM/RRRR'))
         and CO396_MAINOFFERINGID not in (400014,400016,400017,300050,300033,400012,300034,400015,479662,400019,400018,200002,300022,300042,449066,449073,410010,410008,410009,449103,200001,410013,449662,400022,400021)
        
         )E,
        (SELECT /*+PARALLEL(W,8)*/ SUM(A30_DEBIT_AMOUNT) ADJUSTMENT_REVENUE FROM L3_ADJUSTMENT W
         WHERE A22_ENTRY_DATE_KEY = (SELECT DATE_KEY FROM DATE_DIM  WHERE DATE_VALUE = TO_DATE(SYSDATE-1,'DD/MM/RRRR'))
          and A462_MAINOFFERINGID not  in (400014,400016,400017,300050,300033,400012,300034,400015,479662,400019,400018,200002,300022,300042,449066,449073,410010,410008,410009,449103,200001,410013,449662,400022,400021)
         
           )F
)Y;

    COMMIT;
END;
/

